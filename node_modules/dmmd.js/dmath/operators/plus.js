"use strict";

// Imports
const abs = require("../functions/absolute.js");
const format = require("../utils/format.js");
const neg = require("../functions/negative.js");
const parse = require("../utils/parse.js");
const shift = require("../utils/shift.js");

/**
 * Adds two number-like values
 * @param {string|number} a Number-like value
 * @param {string|number} b Number-like value
 * @returns {string}
 */
function plus(a, b) {
    let subtract = require("./subtract.js");
    let [ fla, flb ] = [ a, b ].map(parseFloat);
    if(fla < 0 && flb < 0) return neg(plus(abs(a), abs(b)));
    else if(fla < 0 || flb < 0) return fla < flb ? subtract(b, neg(a)) : subtract(a, neg(b));
    let { array: fa, length: fl } = format([ a, b ].map(parse), false);
    let [ daa, dab ] = fa.map(fn => fn.split(""));
    let r = "", c = 0;
    while(daa.length || dab.length) {
        let [ da, db ] = [ daa, dab ].map(da => parseInt(da.pop() ?? "0"));
        r = `${((da + db + c) % 10)}` + r;
        c = Math.floor((da + db + c) / 10);
    };
    return shift(`${c}` + r, fl);
};

// Exports
module.exports = plus;