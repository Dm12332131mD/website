"use strict";

// Imports
const abs = require("../functions/absolute.js");
const format = require("../utils/format.js");
const neg = require("../functions/negative.js");
const parse = require("../utils/parse.js");
const shift = require("../utils/shift.js");

/**
 * Subtracts two number-like values
 * @param {string|number} a Number-like value
 * @param {string|number} b Number-like value
 * @returns {string}
 */
function subtract(a, b) {
    let plus = require("./plus.js");
    let [ fla, flb ] = [ a, b ].map(parseFloat);
    if(fla < 0 && flb < 0) return neg(subtract(abs(a), abs(b)));
    else if(fla < 0) return neg(plus(abs(a), b));
    else if(flb < 0) return plus(a, abs(b));
    else if(flb > fla) return neg(subtract(b, a));
    let { array: fa, length: fl } = format([ a, b ].map(parse), false);
    let [ daa, dab ] = fa.map(fn => fn.split(""));
    let r = "", c = 0;
    while(daa.length || dab.length) {
        let [ da, db ] = [ daa, dab ].map(da => parseInt(da.pop() ?? "0"));
        r = `${da - c >= db ? da - db - c : 10 - abs(da - db - c)}` + r;
        c = da - c >= db ? 0 : 1;
    };
    return shift(r, fl);
};

// Exports
module.exports = subtract;